# Emma AI Project Context

## Project Overview
Emma AI - Advanced AI Assistant

## Development Guidelines
- AI-first development approach
- Context preservation between sessions
- Iterative development with clear documentation

## Session Context
### Current Status
- Project initialized with package.json
- Basic dependencies configured
- Awaiting project description and optimal function set

### Next Steps
- [ ] Review project description
- [ ] Implement core functionality based on provided functions
- [ ] Set up project structure according to requirements

## Commands
```bash
npm run dev      # Start development server
npm run build    # Build TypeScript
npm run test     # Run tests
npm run lint     # Run ESLint
npm run typecheck # Type checking
```

## Architecture Decisions
- TypeScript for type safety
- Express.js for API server
- Winston for logging
- Anthropic SDK for AI integration

## Notes for Future Sessions

## Recent Changes & Fixes

### üé§ Voice Recording System - Complete Fix Documentation (2025-01-22)

#### –ü—Ä–æ–±–ª–µ–º–∞
**–°–∏–º–ø—Ç–æ–º:** –ö–Ω–æ–ø–∫–∞ –∑–∞–ø–∏—Å–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–ª–∞
- –ö–ª–∏–∫–∏ –Ω–µ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–ª–∏ –∑–∞–ø–∏—Å—å
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å `idle` –ø–æ—Å–ª–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- –ù–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–ª–∏—Å—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª: "–¥–∞ –≤—Å–µ —Ä–∞–≤–Ω–æ–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∏—Ö—É—è –∫–Ω–æ–ø–∫–∞ –∑–∞–ø–∏—Å–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞"

#### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** Development hot reload —Å–æ–∑–¥–∞–≤–∞–ª —Ü–∏–∫–ª —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```tsx
// –î–û (–±–∞–≥):
useEffect(() => {
  // development reset logic
}, [onStateChange, state])  // –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å 'state' –≤—ã–∑—ã–≤–∞–ª–∞ —Ü–∏–∫–ª

// –ü–û–°–õ–ï (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):  
useEffect(() => {
  // development reset logic
}, [onStateChange])  // —É–±—Ä–∞–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å 'state'
```

**–ú–µ—Ö–∞–Ω–∏–∑–º –±–∞–≥–∞:**
1. –ö–ª–∏–∫ ‚Üí —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `listening`
2. useEffect —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–∑-–∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `state` 
3. Development –ª–æ–≥–∏–∫–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ `idle`
4. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è

#### –ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**–û—Å–Ω–æ–≤–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- **–§–∞–π–ª:** `components/voice/VoiceRecorder.tsx:275`
- **–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –£–±—Ä–∞–Ω–∞ `state` –∏–∑ dependency array useEffect
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å—Ç—Ä–∞–Ω–µ–Ω —Ü–∏–∫–ª —Å–±—Ä–æ—Å–∞, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ cleanup —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
1. **–°–∏—Å—Ç–µ–º–∞ –æ—Ç–ª–∞–¥–∫–∏:** –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–≥–æ pipeline –∑–∞–ø–∏—Å–∏
2. **MIME fallback:** –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é  
4. **Dev –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** –ö–Ω–æ–ø–∫–∞ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

#### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**components/voice/VoiceRecorder.tsx:**
- –°—Ç—Ä–æ–∫–∞ 275: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω dependency array bug useEffect
- –°—Ç—Ä–æ–∫–∏ 36-57: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å debug output
- –°—Ç—Ä–æ–∫–∏ 118-127: MIME type fallbacks –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤
- –°—Ç—Ä–æ–∫–∏ 83-237: –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–ø–∏—Å–∏
- –°—Ç—Ä–æ–∫–∏ 397-427: Dev —Ä–µ–∂–∏–º emergency reset controls

**components/voice/VoiceInterface.tsx:**
- –°—Ç—Ä–æ–∫–∞ 109: –£–ª—É—á—à–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è audioLevel prop
- –°—Ç—Ä–æ–∫–∏ 39-65: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –æ—á–∏—Å—Ç–∫–æ–π timeout
- –°—Ç—Ä–æ–∫–∏ 26-29: Debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**MediaRecorder –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ MediaRecorder –∏ getUserMedia API
- Fallback MIME —Ç–∏–ø—ã: opus ‚Üí webm ‚Üí mp4 ‚Üí wav
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ stream –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞—É–¥–∏–æ —É—Ä–æ–≤–Ω—è:**
- –†–∞—Å—á–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ Web Audio API
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ visualizer
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ callback

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫–∞–∑–∞ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, timeout
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é
- Dev —Ä–µ–∂–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∫–ª–∏–∫–∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ó–∞–ø–∏—Å—å –∞—É–¥–∏–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π —Ä–∞–±–æ—Ç–∞—é—Ç –≤ dev –∏ production —Ä–µ–∂–∏–º–∞—Ö
- ‚úÖ –°—Ü–µ–Ω–∞—Ä–∏–∏ –æ—à–∏–±–æ–∫ –¥–∞—é—Ç –ø–æ–ª–µ–∑–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å

**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –±—Ä–∞—É–∑–µ—Ä–æ–≤:**
- ‚úÖ Chrome: –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å opus codec
- ‚úÖ Firefox: –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å webm —Ñ–æ—Ä–º–∞—Ç–æ–º  
- ‚úÖ Safari: Fallback –∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º —Ñ–æ—Ä–º–∞—Ç–∞–º
- ‚úÖ Edge: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ webm

### üîä Voice Components Integration
**–£–ª—É—á—à–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–±—Ä–æ—Å audioLevel –º–µ–∂–¥—É VoiceRecorder ‚Üí VoiceInterface ‚Üí VoiceVisualizer
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ transcribeAudio —Ñ—É–Ω–∫—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ MIME —Ç–∏–ø–æ–≤ —Å fallback'–∞–º–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã React Hook dependencies

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
**MediaRecorder –ø–æ–¥–¥–µ—Ä–∂–∫–∞:**
- MIME —Ç–∏–ø—ã: audio/webm;codecs=opus ‚Üí audio/webm ‚Üí audio/mp4 ‚Üí audio/wav
- –ü—Ä–æ–≤–µ—Ä–∫–∞ browser support —Å isSecureContext
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å console.log –ª–æ–≥–∞–º–∏

### üìù MCP Servers Available
**–ö–æ–º–∞–Ω–¥—ã Context7:**
- `mcp__context7__resolve-library-id` - –ü–æ–∏—Å–∫ ID –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- `mcp__context7__get-library-docs` - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã:**
- Sequential Thinking (`@modelcontextprotocol/server-sequential-thinking`)
- GitHub MCP (`@andrebuzeli/github-mcp-v2`)
- Magic (`@21st-dev/cli`)
- Upstash Context7 (`@upstash/context7-mcp`)

Add your project-specific notes here...